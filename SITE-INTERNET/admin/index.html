<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn AI Commenter - Admin Dashboard</title>
    <style>
        /* Reset et base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Header */
        header {
            background-color: #0077B5;
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        #auth-status {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        /* Main */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Sections */
        section {
            margin-bottom: 2rem;
        }

        /* Section Login */
        #login-section {
            background: white;
            border-radius: 8px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        #login-section p {
            margin-bottom: 1.5rem;
            color: #6b7280;
            font-size: 1.125rem;
        }

        #login-btn {
            background-color: #0077B5;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            font-size: 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #login-btn:hover {
            background-color: #005a8c;
        }

        /* Dashboard Container */
        #dashboard-section {
            display: block;
        }

        /* Tabs */
        .tabs-container {
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid #e5e7eb;
        }

        .tabs-nav {
            display: flex;
            gap: 0;
        }

        .tab-btn {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .tab-btn.active {
            color: #0077B5;
            border-bottom-color: #0077B5;
            font-weight: 600;
        }

        .tab-btn:hover {
            color: #0077B5;
            background: rgba(0, 119, 181, 0.05);
        }

        [data-tab-panel] {
            display: none;
            padding: 2rem;
        }

        [data-tab-panel].active {
            display: block;
        }

        /* Period Selector */
        .period-selector {
            padding: 1rem 2rem;
            display: flex;
            justify-content: flex-end;
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }

        .period-group {
            display: inline-flex;
            background: #f3f4f6;
            border-radius: 6px;
            padding: 4px;
        }

        .period-btn {
            background: transparent;
            border: none;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            color: #6b7280;
            cursor: pointer;
            border-radius: 4px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .period-btn.active {
            background: #0077B5;
            color: white;
            font-weight: 600;
        }

        .period-btn:hover:not(.active) {
            background: rgba(0, 119, 181, 0.1);
            color: #0077B5;
        }

        /* KPI Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .kpi-card {
            background: white;
            border-radius: 8px;
            padding: 1.25rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .kpi-card h3 {
            font-size: 0.813rem;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
        }

        .kpi-detail {
            font-size: 0.813rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .kpi-trend {
            display: inline-flex;
            align-items: center;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .kpi-trend.up {
            color: #10b981;
        }

        .kpi-trend.down {
            color: #ef4444;
        }

        .kpi-trend.neutral {
            color: #6b7280;
        }

        /* Users Consumption Table */
        #users-consumption-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        #users-consumption-table th {
            text-align: left;
            padding: 0.75rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            cursor: pointer;
            background: #f9fafb;
        }

        #users-consumption-table th:hover {
            background: #f3f4f6;
        }

        #users-consumption-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }

        #users-consumption-table tr[data-user-id] {
            cursor: pointer;
        }

        #users-consumption-table tr[data-user-id]:hover {
            background: #f3f4f6;
        }

        #users-consumption-table tr.expanded {
            background: #eef2ff;
        }

        .drill-down-row td {
            padding: 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .drill-down-content {
            padding: 1rem 2rem;
            background: #f8fafc;
        }

        .generations-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.813rem;
            margin-top: 0.5rem;
        }

        .generations-table th {
            text-align: left;
            padding: 0.5rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
        }

        .generations-table td {
            padding: 0.5rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .comment-preview {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-size: 0.75rem;
            color: #6b7280;
        }

        .load-more-btn {
            display: block;
            margin: 1rem auto;
            padding: 0.5rem 1.5rem;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.813rem;
        }

        .load-more-btn:hover {
            background: #e5e7eb;
        }

        #users-empty {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
            font-size: 0.875rem;
        }

        /* Error Section */
        #error-section {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #ef4444;
        }

        #error-message {
            color: #dc2626;
            font-size: 1rem;
        }

        /* Loading State */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Fix L2: Loading Spinner */
        #loading-spinner {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
            gap: 1rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top-color: #0077B5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .spinner-text {
            color: #374151;
            font-size: 0.875rem;
        }

        /* Fix M4: Login message */
        #login-message {
            display: none;
            color: #dc2626;
            background: #fef2f2;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 0.5rem;
                text-align: center;
            }

            main {
                padding: 1rem;
            }

            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .tabs-nav {
                flex-wrap: wrap;
            }

            .tab-btn {
                padding: 0.75rem 1rem;
            }

            .period-selector {
                justify-content: center;
            }

            #users-consumption-table {
                font-size: 0.75rem;
            }

            #users-consumption-table th,
            #users-consumption-table td {
                padding: 0.5rem;
            }

            /* Table scrolling wrapper */
            [data-tab-panel="users"] {
                overflow-x: auto;
            }

            .usage-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Logout button */
        #logout-btn {
            background-color: transparent;
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-left: 1rem;
        }

        #logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .auth-container {
            display: flex;
            align-items: center;
        }

        /* Google Sign-In Button (Story 4-3) */
        .google-signin-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            padding: 0.75rem 1.5rem;
            background-color: white;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s;
        }

        .google-signin-btn:hover {
            background-color: #f9fafb;
            border-color: #d1d5db;
        }

        .google-signin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        #jwt-manual-link:hover {
            color: #0077B5;
        }

        /* Usage Tab - Grid 2x2 */
        .usage-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            padding: 0;
        }

        .usage-card {
            background: white;
            border-radius: 8px;
            padding: 1.25rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .usage-card-header h3 {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .usage-card-subtitle {
            font-size: 0.813rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .chart-container {
            width: 100%;
            height: 350px;
        }

        .dimension-selector {
            margin-top: 0.5rem;
            padding: 0.375rem 0.75rem;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            font-size: 0.875rem;
            color: #374151;
            background: white;
            cursor: pointer;
        }

        .dimension-selector:focus {
            outline: none;
            border-color: #0077B5;
            box-shadow: 0 0 0 2px rgba(0, 119, 181, 0.2);
        }

        /* User Detail Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: flex-start;
            padding-top: 5vh;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 560px;
            max-width: 95vw;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalIn 0.2s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-section {
            margin-bottom: 1.25rem;
        }

        .modal-section h3 {
            font-size: 0.813rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #6b7280;
            margin-bottom: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            padding-bottom: 0.5rem;
        }

        .modal-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
        }

        .modal-field label {
            font-size: 0.875rem;
            color: #374151;
            font-weight: 500;
        }

        .modal-field .value {
            font-size: 0.875rem;
            color: #1f2937;
        }

        .modal-field select,
        .modal-field input[type="datetime-local"] {
            padding: 0.375rem 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 0.875rem;
            color: #1f2937;
        }

        .modal-field select:focus,
        .modal-field input:focus {
            outline: none;
            border-color: #0077B5;
            box-shadow: 0 0 0 2px rgba(0, 119, 181, 0.2);
        }

        .role-badge-modal {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }

        .role-badge-modal.FREE { background: #6b7280; }
        .role-badge-modal.MEDIUM { background: #3b82f6; }
        .role-badge-modal.PREMIUM { background: #10b981; }

        .days-remaining {
            font-size: 0.75rem;
            color: #10b981;
            font-weight: 600;
            margin-left: 8px;
        }

        .days-remaining.expired {
            color: #ef4444;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.75rem;
        }

        .history-table th {
            text-align: left;
            padding: 0.375rem 0.5rem;
            color: #6b7280;
            font-weight: 600;
            border-bottom: 1px solid #e5e7eb;
        }

        .history-table td {
            padding: 0.375rem 0.5rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        .modal-btn {
            padding: 0.5rem 1.25rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn-cancel {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #374151;
        }

        .modal-btn-cancel:hover {
            background: #e5e7eb;
        }

        .modal-btn-save {
            background: #0077B5;
            border: none;
            color: white;
        }

        .modal-btn-save:hover {
            background: #005a8c;
        }

        .modal-btn-save:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .toggle-active {
            position: relative;
            width: 44px;
            height: 24px;
            background: #d1d5db;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toggle-active.on {
            background: #10b981;
        }

        .toggle-active::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
        }

        .toggle-active.on::after {
            transform: translateX(20px);
        }

        /* Edit action button in table */
        .edit-user-btn {
            background: none;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 4px 10px;
            font-size: 0.75rem;
            cursor: pointer;
            color: #0077B5;
            transition: all 0.2s;
        }

        .edit-user-btn:hover {
            background: #0077B5;
            color: white;
            border-color: #0077B5;
        }
    </style>
</head>
<body>
    <header>
        <h1>Admin Dashboard</h1>
        <div class="auth-container">
            <span id="auth-status"></span>
            <button id="logout-btn" style="display: none;">Deconnexion</button>
        </div>
    </header>

    <!-- Fix L2: Loading Spinner Overlay -->
    <div id="loading-spinner">
        <div class="spinner"></div>
        <span class="spinner-text">Chargement des donnees...</span>
    </div>

    <main>
        <!-- Section Login (si non authentifie) -->
        <section id="login-section" style="display: none;">
            <!-- Fix M4: Message contextuel pour erreurs auth -->
            <div id="login-message"></div>
            <p>Veuillez vous connecter pour acceder au dashboard.</p>

            <!-- Bouton Google OAuth (Story 4-3) -->
            <button id="google-signin-btn" class="google-signin-btn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.6 10.227c0-.709-.064-1.39-.182-2.045H10v3.868h5.382a4.6 4.6 0 01-1.996 3.018v2.51h3.232c1.891-1.742 2.982-4.305 2.982-7.35z" fill="#4285F4"/>
                    <path d="M10 20c2.7 0 4.964-.895 6.618-2.423l-3.232-2.509c-.895.6-2.04.955-3.386.955-2.605 0-4.81-1.76-5.595-4.123H1.064v2.59A9.996 9.996 0 0010 20z" fill="#34A853"/>
                    <path d="M4.405 11.9c-.2-.6-.314-1.24-.314-1.9 0-.66.114-1.3.314-1.9V5.51H1.064A9.996 9.996 0 000 10c0 1.614.386 3.14 1.064 4.49l3.34-2.59z" fill="#FBBC05"/>
                    <path d="M10 3.977c1.468 0 2.786.505 3.823 1.496l2.868-2.868C14.959.99 12.695 0 10 0 6.09 0 2.71 2.24 1.064 5.51l3.34 2.59C5.19 5.736 7.395 3.977 10 3.977z" fill="#EA4335"/>
                </svg>
                <span>Se connecter avec Google</span>
            </button>

            <!-- Fallback JWT manuel (mode avance) -->
            <p style="margin-top: 1.5rem; font-size: 0.875rem; color: #9ca3af;">
                <a href="#" id="jwt-manual-link" style="color: #6b7280; text-decoration: underline;">Mode avance (JWT manuel)</a>
            </p>
        </section>

        <!-- Section Dashboard (si authentifie admin) -->
        <section id="dashboard-section" style="display: none;">
            <!-- Tabs Navigation -->
            <div class="tabs-container" id="admin-tabs">
                <div class="tabs-nav" role="tablist">
                    <button class="tab-btn active" data-tab="overview" role="tab" aria-selected="true">Overview</button>
                    <button class="tab-btn" data-tab="users" role="tab" aria-selected="false">Utilisateurs</button>
                    <button class="tab-btn" data-tab="usage" role="tab" aria-selected="false">Usage</button>
                </div>
            </div>

            <!-- Period Selector (global) -->
            <div class="period-selector" id="period-selector">
                <div class="period-group" role="group" aria-label="Selecteur de periode">
                    <button class="period-btn" data-period="7d">7 jours</button>
                    <button class="period-btn active" data-period="30d">30 jours</button>
                    <button class="period-btn" data-period="90d">90 jours</button>
                </div>
            </div>

            <!-- Overview Tab -->
            <div data-tab-panel="overview" class="active">
                <div class="kpi-grid" id="kpi-grid">
                    <!-- KPI Card 1: Utilisateurs -->
                    <div class="kpi-card">
                        <h3>Utilisateurs</h3>
                        <div class="kpi-value" id="kpi-users-total">-</div>
                        <div class="kpi-detail" id="kpi-users-detail">-</div>
                    </div>

                    <!-- KPI Card 2: Commentaires -->
                    <div class="kpi-card">
                        <h3>Commentaires</h3>
                        <div class="kpi-value" id="kpi-comments-total">-</div>
                        <div class="kpi-detail" id="kpi-comments-trend"></div>
                    </div>

                    <!-- KPI Card 3: Cout estime -->
                    <div class="kpi-card">
                        <h3>Cout estime</h3>
                        <div class="kpi-value" id="kpi-cost-total">-</div>
                        <div class="kpi-detail" id="kpi-cost-trend"></div>
                    </div>

                    <!-- KPI Card 4: Trials actifs -->
                    <div class="kpi-card">
                        <h3>Trials actifs</h3>
                        <div class="kpi-value" id="kpi-trials">-</div>
                        <div class="kpi-detail">Utilisateurs en periode d'essai</div>
                    </div>
                </div>
            </div>

            <!-- Users Tab -->
            <div data-tab-panel="users">
                <table id="users-consumption-table">
                    <thead>
                        <tr>
                            <th data-sort="email">Email</th>
                            <th data-sort="role">Role</th>
                            <th data-sort="generation_count">Generations</th>
                            <th data-sort="total_tokens">Tokens</th>
                            <th data-sort="cost_eur">Cout EUR</th>
                            <th data-sort="last_generation">Dernier usage</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div id="users-empty" style="display:none;">Aucun utilisateur avec des generations sur cette periode.</div>
            </div>

            <!-- Usage Tab -->
            <div data-tab-panel="usage">
                <div class="usage-grid">
                    <!-- Haut-gauche: Feature Adoption -->
                    <div class="usage-card">
                        <div class="usage-card-header">
                            <h3>Adoption Features Premium</h3>
                            <p class="usage-card-subtitle">Taux d'utilisation des fonctionnalites avancees</p>
                        </div>
                        <div id="chart-features" class="chart-container"></div>
                    </div>

                    <!-- Haut-droite: Distributions -->
                    <div class="usage-card">
                        <div class="usage-card-header">
                            <h3>Distribution des Parametres</h3>
                            <p class="usage-card-subtitle">Repartition par dimension d'usage</p>
                            <select id="dimension-selector" class="dimension-selector">
                                <option value="tone">Tone</option>
                                <option value="emotion">Emotion</option>
                                <option value="style">Style</option>
                                <option value="language">Langue</option>
                                <option value="news_enrichment_mode">Mode News</option>
                            </select>
                        </div>
                        <div id="chart-distributions" class="chart-container"></div>
                    </div>

                    <!-- Bas-gauche: Tendances -->
                    <div class="usage-card">
                        <div class="usage-card-header">
                            <h3>Tendances d'Usage</h3>
                            <p class="usage-card-subtitle">Evolution des features premium (12 dernieres semaines)</p>
                        </div>
                        <div id="chart-trends" class="chart-container"></div>
                    </div>

                    <!-- Bas-droite: Segmentation Role -->
                    <div class="usage-card">
                        <div class="usage-card-header">
                            <h3>Usage par Role</h3>
                            <p class="usage-card-subtitle">Segmentation FREE / MEDIUM / PREMIUM</p>
                        </div>
                        <div id="chart-roles" class="chart-container"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Erreur (si non admin) -->
        <section id="error-section" style="display: none;">
            <p id="error-message"></p>
            <button id="retry-btn" style="margin-top: 1rem; padding: 0.5rem 1rem; cursor: pointer;">Reessayer</button>
        </section>
    </main>

    <!-- Modal Detail/Edit Utilisateur -->
    <div class="modal-overlay" id="user-modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modal-user-title">Utilisateur</h2>
                <button class="modal-close" id="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Info generales -->
                <div class="modal-section">
                    <h3>Informations</h3>
                    <div class="modal-field">
                        <label>Email</label>
                        <span class="value" id="modal-email">-</span>
                    </div>
                    <div class="modal-field">
                        <label>Inscrit le</label>
                        <span class="value" id="modal-created">-</span>
                    </div>
                    <div class="modal-field">
                        <label>Profil LinkedIn</label>
                        <span class="value" id="modal-linkedin">-</span>
                    </div>
                    <div class="modal-field">
                        <label>Actif</label>
                        <button class="toggle-active on" id="modal-is-active" type="button"></button>
                    </div>
                </div>

                <!-- Role & Abonnement -->
                <div class="modal-section">
                    <h3>Role & Abonnement</h3>
                    <div class="modal-field">
                        <label>Role</label>
                        <select id="modal-role">
                            <option value="FREE">FREE</option>
                            <option value="MEDIUM">MEDIUM</option>
                            <option value="PREMIUM">PREMIUM</option>
                        </select>
                    </div>
                    <div class="modal-field">
                        <label>Statut Stripe</label>
                        <span class="value" id="modal-subscription-status">-</span>
                    </div>
                </div>

                <!-- Trial & Grace -->
                <div class="modal-section">
                    <h3>Trial & Grace</h3>
                    <div class="modal-field">
                        <label>Trial demarre le</label>
                        <span class="value" id="modal-trial-started">-</span>
                    </div>
                    <div class="modal-field">
                        <label>Trial expire le</label>
                        <div>
                            <input type="datetime-local" id="modal-trial-ends" />
                            <span class="days-remaining" id="modal-trial-remaining"></span>
                        </div>
                    </div>
                    <div class="modal-field">
                        <label>Grace expire le</label>
                        <div>
                            <input type="datetime-local" id="modal-grace-ends" />
                            <span class="days-remaining" id="modal-grace-remaining"></span>
                        </div>
                    </div>
                </div>

                <!-- Historique des roles -->
                <div class="modal-section">
                    <h3>Historique des roles</h3>
                    <table class="history-table" id="modal-role-history">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Changement</th>
                                <th>Par</th>
                                <th>Raison</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" id="modal-cancel-btn">Annuler</button>
                <button class="modal-btn modal-btn-save" id="modal-save-btn">Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Google Identity Services (OAuth 2.0) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script src="admin.js"></script>
</body>
</html>
